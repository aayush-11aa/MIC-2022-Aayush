-   [Load data](#load-data)
-   [1. Identify DEGs between clusters](#identify-degs-between-clusters)
    -   [Find DEGs that identify “Cluster
        0”](#find-degs-that-identify-cluster-0)
    -   [Run FindMakers() for each
        cluster](#run-findmakers-for-each-cluster)
-   [2. Re-name clusters](#re-name-clusters)
-   [3. Verify manuscript DE results](#verify-manuscript-de-results)

``` r
knitr::opts_chunk$set(echo = T, message = FALSE, warning = FALSE)
stdt<-date()

# Libraries
library(tidyverse)
```

    ## Warning in system("timedatectl", intern = TRUE): running command 'timedatectl'
    ## had status 1

    ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──

    ## ✔ ggplot2 3.3.6     ✔ purrr   0.3.4
    ## ✔ tibble  3.1.7     ✔ dplyr   1.0.9
    ## ✔ tidyr   1.2.0     ✔ stringr 1.4.0
    ## ✔ readr   2.1.2     ✔ forcats 0.5.1

    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()

``` r
library(Seurat)
```

    ## Attaching SeuratObject

    ## Attaching sp

``` r
library(cowplot)

# Paths
wd <- "/hpc/group/chsi-mic-2022"
intermeddir <- file.path(wd, "intermed")
outdir <- file.path("/work",Sys.info()[["user"]],"output")
outdir
```

    ## [1] "/work/mrl17/output"

**Goal of this workshop:** Learn how to test differential expression
between cells

**What’s covered in this workshop:** - Identify DEGs between clusters -
Re-name clusters - Verify manuscript DE results

**Data source:** Christian et al. 2021 Cell Reports
(<https://doi.org/10.1016/j.celrep.2021.109118>)

Note that the Seurat - Guided Clustering Tutorial
(<https://satijalab.org/seurat/articles/pbmc3k_tutorial.html>) includes
a lot of overlapping information.

**METHOD DETAILS, Single-cell RNA-seq analysis, page e4**

-   Pre-processing: “Raw short reads were demultiplexed, filtering and
    mapped to mouse genome GRCm38/mm10 using cellranger v2.02.”

-   QC: “The gene count matrices from cellranger were subjected to
    quality control, pre-processing and clustering using the R Seurat
    2.3.4 package (Butler et al., 2018). Low-quality cells that had less
    than 200 expressed genes and more than 5% mitochondrial genes were
    filtered out.”

-   Analysis: “Gene counts were scaled to total gene expression and
    percentage of mitochondrial genes with a scaling factor of 10,000,
    and then log-transformed. The high dimensional data for each sample
    were reduced by PCA and t-Distributed Stochastics Neighbor Embedding
    (tSNE). We used the FindCluster function to group clusters in each
    sample with a resolution of 0.6. Differential expressed genes (DEGs)
    were identified using the Wilcoxon rank-sum test.”

## Load data

``` r
seulist.drc <- readRDS(file.path(intermeddir, "seulist_drc.rds"))
```

## 1. Identify DEGs between clusters

*METHOD DETAILS, Single-cell RNA-seq analysis, page 4e*: “Differential
expressed genes (DEGs) were identified using the Wilcoxon rank-sum
test.”

Identify Tem cluster biomarkers (Fig2B-D)

``` r
tem <- seulist.drc[["Tem"]]
tem@meta.data %>%
  pull(seurat_clusters) %>% unique()
```

    ## [1] 5 1 0 4 3 2
    ## Levels: 0 1 2 3 4 5

For the purpose of trying to reproduce the manuscript results, we will
assume that the authors use defaults. Here are a few default arguments
to be aware of:

**min.pct = 0.1** : Do not test genes that make up fewer than 0.1
fraction (10% ?) of the total reads in either of the populations tested.
Meant to speed up the function by not testing genes that are very
infrequently expressed. Default is 0.1 – **NOTE: Marissa tried to
re-write this so that it is clearer, please check**

**max.cells.per.ident = Inf** : “This will downsample each identity
class to have no more cells than whatever this is set to. While there is
generally going to be a loss in power, the speed increases can be
significant and the most highly differentially expressed features will
likely still rise to the top”
(<https://satijalab.org/seurat/articles/pbmc3k_tutorial.html>)

**logfc.threshold = 0.25** “Limit testing to genes which show, on
average, at least X-fold difference (log-scale) between the two groups
of cells. Default is 0.25 Increasing logfc.threshold speeds up the
function, but can miss weaker signals.” (Seurat help)

**test.use = “wilcox** Denotes which test to use; see Seurat help for
alternatives.

**min.cells.group = 3** “Minimum number of cells in one of the groups”
(Seurat help)

**ident.2** “A second identity class for comparison; if NULL, use all
other cells for comparison” (Seurat help)

### Find DEGs that identify “Cluster 0”

``` r
cluster0.markers <- FindMarkers(tem, ident.1 = 0)
cluster0.markers %>%
  arrange(-avg_log2FC) %>%
  head(n = 5)
```

    ##                p_val avg_log2FC pct.1 pct.2    p_val_adj
    ## Bcl2    2.175929e-28  0.8085540 0.855 0.608 2.735360e-24
    ## Dapl1   3.665931e-09  0.6328763 0.126 0.039 4.608442e-05
    ## Rps28   3.679618e-70  0.5631877 1.000 0.999 4.625647e-66
    ## Rps27rt 8.884549e-46  0.5063820 1.000 0.996 1.116877e-41
    ## Gm10260 3.618803e-44  0.5046848 1.000 0.994 4.549197e-40

**Examine Wilcoxon Rank Sum test** – NOTE: Needs attention!

Try to reproduce results for “Bcl2” by doing the Wilcoxon Rank Sum test
another way.

``` r
# Select the gene Bcl2
sel.gene <- "Bcl2"

# subset cells in cluster 0
tem.0 <- subset(x = tem, idents = "0")
ncol(x = tem.0) # 317 cells
```

    ## [1] 317

``` r
unique(Idents(tem.0)) # check that these are all from the 0 cluster
```

    ## [1] 0
    ## Levels: 0

``` r
# subset cells in any other cluster
tem.else <- subset(x = tem, idents = "0", invert = TRUE)
ncol(x = tem.else) # 1140 cells
```

    ## [1] 1140

``` r
unique(Idents(tem.else)) # check that these are all from clusters other than 0
```

    ## [1] 5 1 4 3 2
    ## Levels: 1 2 3 4 5

``` r
# extract scaled expression values
expr.0 <- GetAssayData(object = tem.0, slot = "scale.data")
expr.else <- GetAssayData(object = tem.else, slot = "scale.data")

# Extract expression values for the gene Bcl2
expr.0.sel <- expr.0[rownames(expr.0) == sel.gene,]
expr.else.sel <- expr.0[rownames(expr.else) == sel.gene,]

# Perform the Wilcoxon Rank Sum test 
wilcox.test(x = expr.0.sel, 
            y = expr.else.sel, alternative = "two.sided")
```

    ## 
    ##  Wilcoxon rank sum test with continuity correction
    ## 
    ## data:  expr.0.sel and expr.else.sel
    ## W = 50244, p-value = 1
    ## alternative hypothesis: true location shift is not equal to 0

``` r
# p-value < 2.2e-16

cluster0.markers %>%
  rownames_to_column(var = "gene_name") %>%
  filter(gene_name == sel.gene)
```

    ##   gene_name        p_val avg_log2FC pct.1 pct.2   p_val_adj
    ## 1      Bcl2 2.175929e-28   0.808554 0.855 0.608 2.73536e-24

``` r
# p-value = 2.175929e-28    
```

Do this again for a gene with a less extreme p-value, e.g. Nkg7

``` r
cluster0.markers %>%
  arrange(-p_val)
```

    ##                      p_val avg_log2FC pct.1 pct.2    p_val_adj
    ## Nkg7          5.104688e-01 -0.2809875 0.924 0.716 1.000000e+00
    ## Tubb5         2.995549e-01 -0.2978744 0.562 0.625 1.000000e+00
    ## 1810043H04Rik 2.011818e-01  0.2560019 0.262 0.253 1.000000e+00
    ## Ifitm1        1.483460e-01 -0.2784547 0.274 0.319 1.000000e+00
    ## Klrd1         6.859196e-02 -0.4086322 0.445 0.469 1.000000e+00
    ## Rpl36-ps3     4.459634e-02  0.2688056 0.262 0.230 1.000000e+00
    ## Rnf138        3.732511e-02  0.2855022 0.410 0.376 1.000000e+00
    ## Zfos1         3.150027e-02  0.2767864 0.479 0.468 1.000000e+00
    ## Itga4         3.064526e-02  0.2794281 0.375 0.332 1.000000e+00
    ## Kcnq1ot1      1.917593e-02  0.2600318 0.215 0.168 1.000000e+00
    ## Ehd3          1.742680e-02  0.2510477 0.186 0.140 1.000000e+00
    ## Txk           1.424454e-02  0.3530518 0.265 0.217 1.000000e+00
    ## Tuba1b        1.308956e-02 -0.5354733 0.315 0.393 1.000000e+00
    ## Tnfrsf18      1.173987e-02 -0.3525595 0.486 0.562 1.000000e+00
    ## Gnl3          1.030244e-02  0.2700687 0.167 0.119 1.000000e+00
    ## B4galnt1      9.698040e-03  0.2558491 0.502 0.469 1.000000e+00
    ## Gimap9        8.569506e-03  0.2825741 0.382 0.331 1.000000e+00
    ## Rabac1        7.995538e-03  0.2819974 0.584 0.575 1.000000e+00
    ## Pcna          7.424847e-03 -0.2794433 0.167 0.239 1.000000e+00
    ## AB124611      6.924725e-03  0.3066530 0.278 0.224 1.000000e+00
    ## Klk8          6.487367e-03  0.2680690 0.454 0.418 1.000000e+00
    ## Cpne3         6.427346e-03  0.2941020 0.174 0.122 1.000000e+00
    ## Tbc1d4        4.764227e-03 -0.2742014 0.054 0.106 1.000000e+00
    ## Ndufaf4       4.600079e-03  0.2826329 0.180 0.126 1.000000e+00
    ## Bcl2l11       3.971573e-03  0.3340295 0.208 0.147 1.000000e+00
    ## Sh2d1a        3.801571e-03 -0.2874428 0.265 0.359 1.000000e+00
    ## Itgb7         2.646303e-03 -0.2728593 0.511 0.619 1.000000e+00
    ## 1810041H14Rik 2.495093e-03  0.2811073 0.107 0.061 1.000000e+00
    ## Klrc2         2.263311e-03 -0.2588890 0.189 0.282 1.000000e+00
    ## Smc2          2.064201e-03 -0.2989325 0.088 0.157 1.000000e+00
    ## Arl4c         2.048400e-03  0.3145837 0.293 0.226 1.000000e+00
    ## Gm8369        1.405453e-03  0.3108687 0.612 0.569 1.000000e+00
    ## Klf2          1.358967e-03  0.3336159 0.256 0.185 1.000000e+00
    ## Hmha1         1.240605e-03  0.2930839 0.707 0.704 1.000000e+00
    ## Ube2s         1.205276e-03 -0.2656506 0.196 0.296 1.000000e+00
    ## Sat1          1.137889e-03 -0.2779274 0.268 0.382 1.000000e+00
    ## Anp32b        1.109244e-03 -0.2529608 0.454 0.571 1.000000e+00
    ## Fos           9.316040e-04 -0.4241889 0.180 0.275 1.000000e+00
    ## Arf1          8.419113e-04 -0.2621071 0.467 0.587 1.000000e+00
    ## Sidt1         7.541052e-04  0.3384987 0.161 0.100 1.000000e+00
    ## Epsti1        7.384350e-04 -0.3085363 0.293 0.402 1.000000e+00
    ## Jun           7.322480e-04 -0.2582708 0.177 0.275 1.000000e+00
    ## Dek           7.052430e-04 -0.3260201 0.372 0.501 1.000000e+00
    ## Sdf4          6.027206e-04 -0.2967882 0.438 0.569 1.000000e+00
    ## Ptpn22        5.700230e-04  0.3338603 0.577 0.523 1.000000e+00
    ## Rilpl2        5.654504e-04 -0.2881249 0.177 0.280 1.000000e+00
    ## Hspa9         5.545164e-04  0.3010314 0.215 0.141 1.000000e+00
    ## Timm13        5.269417e-04 -0.2608058 0.445 0.586 1.000000e+00
    ## Gzmk          5.070360e-04 -0.2781084 0.123 0.217 1.000000e+00
    ## Tsc22d3       4.592679e-04  0.3972003 0.391 0.318 1.000000e+00
    ## Fnbp1         4.523764e-04 -0.2568197 0.379 0.520 1.000000e+00
    ## Stk17b        4.490440e-04 -0.2555465 0.473 0.626 1.000000e+00
    ## Cct2          4.435170e-04 -0.2635665 0.278 0.404 1.000000e+00
    ## Tagln2        3.954249e-04 -0.3180706 0.580 0.677 1.000000e+00
    ## Nucks1        3.474492e-04 -0.2558405 0.170 0.278 1.000000e+00
    ## Foxp1         3.471726e-04  0.4071002 0.322 0.240 1.000000e+00
    ## Smim15        3.446982e-04 -0.2550772 0.177 0.286 1.000000e+00
    ## 1600014C10Rik 3.162720e-04 -0.2808500 0.126 0.220 1.000000e+00
    ## Zap70         3.162644e-04 -0.2544493 0.233 0.354 1.000000e+00
    ## Ywhab         2.954863e-04 -0.2596077 0.360 0.493 1.000000e+00
    ## Vcp           2.709664e-04 -0.2656370 0.158 0.263 1.000000e+00
    ## Tmem256       2.328152e-04 -0.2513665 0.303 0.439 1.000000e+00
    ## Ptma          2.312294e-04 -0.4473575 0.972 0.970 1.000000e+00
    ## Gabarapl2     2.281941e-04 -0.3384274 0.606 0.703 1.000000e+00
    ## Tmpo          2.278605e-04 -0.3114564 0.129 0.226 1.000000e+00
    ## Srp9          2.272249e-04 -0.2669640 0.473 0.604 1.000000e+00
    ## Crem          2.228699e-04 -0.4509753 0.211 0.312 1.000000e+00
    ## Srsf3         2.092235e-04 -0.2799700 0.495 0.628 1.000000e+00
    ## Fam32a        2.070910e-04 -0.3008752 0.356 0.487 1.000000e+00
    ## Fam189b       2.024600e-04  0.3391720 0.353 0.268 1.000000e+00
    ## Ifng          1.936481e-04 -0.6600467 0.066 0.147 1.000000e+00
    ## Raly          1.901726e-04 -0.2782134 0.511 0.632 1.000000e+00
    ## Mrps14        1.820202e-04 -0.2595353 0.356 0.508 1.000000e+00
    ## Tuba1a        1.765389e-04 -0.2890480 0.158 0.271 1.000000e+00
    ## Sri           1.679706e-04 -0.2745295 0.476 0.621 1.000000e+00
    ## Ifitm2        1.665342e-04 -0.3795717 0.268 0.396 1.000000e+00
    ## Psmd8         1.614048e-04 -0.2540423 0.315 0.458 1.000000e+00
    ## Psmc5         1.588822e-04 -0.2513004 0.148 0.261 1.000000e+00
    ## Erp44         1.585818e-04 -0.2511710 0.180 0.299 1.000000e+00
    ## Sptssa        1.476379e-04 -0.3188789 0.369 0.518 1.000000e+00
    ## Dut           1.337317e-04 -0.4051185 0.221 0.333 1.000000e+00
    ## Cd5           1.324377e-04 -0.2509543 0.224 0.355 1.000000e+00
    ## Fam134b       1.310438e-04 -0.2625084 0.073 0.159 1.000000e+00
    ## Spcs1         1.274980e-04 -0.2862016 0.369 0.504 1.000000e+00
    ## Ciapin1       1.248987e-04 -0.2566224 0.088 0.182 1.000000e+00
    ## Ptpn1         1.222860e-04 -0.2712308 0.196 0.323 1.000000e+00
    ## Capns1        1.202294e-04 -0.2757690 0.363 0.509 1.000000e+00
    ## H1f0          1.160960e-04 -0.2702860 0.076 0.165 1.000000e+00
    ## Klrc1         1.116635e-04 -0.5870375 0.278 0.386 1.000000e+00
    ## Pomp          1.112466e-04 -0.2719291 0.467 0.596 1.000000e+00
    ## Lrp10         1.104983e-04 -0.2539894 0.192 0.317 1.000000e+00
    ## Actn2         1.052611e-04 -0.3624911 0.054 0.131 1.000000e+00
    ## H2afx         1.043194e-04 -0.4387937 0.101 0.197 1.000000e+00
    ## Hspe1         1.041874e-04  0.3266026 0.700 0.675 1.000000e+00
    ## Bsg           1.033845e-04 -0.2594320 0.379 0.533 1.000000e+00
    ## Csnk2b        1.010732e-04 -0.2755873 0.293 0.439 1.000000e+00
    ## Itgb2         9.875974e-05 -0.3226642 0.274 0.411 1.000000e+00
    ## Ifi27l2a      9.772102e-05 -0.6313088 0.785 0.847 1.000000e+00
    ## Tpm3-rs7      9.771276e-05 -0.2570000 0.612 0.740 1.000000e+00
    ## Taldo1        9.493494e-05 -0.2764472 0.309 0.454 1.000000e+00
    ## Ly6a          9.365396e-05  0.4703420 0.265 0.175 1.000000e+00
    ## Ndufv2        9.194967e-05 -0.2703539 0.256 0.392 1.000000e+00
    ## Atp6v0e       9.194789e-05 -0.2723045 0.565 0.707 1.000000e+00
    ## Kif5b         9.180023e-05 -0.2923955 0.252 0.388 1.000000e+00
    ## March2        9.077647e-05 -0.2569411 0.145 0.259 1.000000e+00
    ## Top2a         9.043549e-05 -0.5267456 0.073 0.159 1.000000e+00
    ## 2700094K13Rik 8.943503e-05 -0.4328437 0.303 0.426 1.000000e+00
    ## Serp1         8.815063e-05 -0.2512356 0.192 0.314 1.000000e+00
    ## Smco4         8.719302e-05 -0.2695352 0.095 0.192 1.000000e+00
    ## Cbfb          8.566114e-05 -0.2536032 0.110 0.215 1.000000e+00
    ## Sf3b1         8.213961e-05 -0.2575773 0.312 0.459 1.000000e+00
    ## Xlr4b         8.194940e-05 -0.2501404 0.139 0.252 1.000000e+00
    ## Tap1          8.110759e-05 -0.2778280 0.227 0.362 1.000000e+00
    ## Necap2        7.717370e-05 -0.2644724 0.091 0.188 9.701505e-01
    ## Tiprl         7.600762e-05 -0.2512766 0.114 0.220 9.554918e-01
    ## Dnajc1        7.475419e-05 -0.3051944 0.120 0.226 9.397349e-01
    ## Usmg5         7.347229e-05 -0.2865957 0.514 0.680 9.236202e-01
    ## Capza2        7.029738e-05 -0.2581728 0.328 0.474 8.837084e-01
    ## Ran           6.759552e-05 -0.3852147 0.539 0.653 8.497433e-01
    ## Gm12840       6.755887e-05 -0.4111013 0.249 0.375 8.492826e-01
    ## Dnajb11       6.367904e-05 -0.2573978 0.167 0.292 8.005092e-01
    ## Pbrm1         6.353331e-05 -0.2728988 0.151 0.270 7.986772e-01
    ## Cox20         6.247420e-05 -0.2978572 0.215 0.350 7.853632e-01
    ## Chmp2a        6.158062e-05 -0.2583691 0.334 0.496 7.741300e-01
    ## BC031181      6.066797e-05 -0.2749980 0.287 0.428 7.626570e-01
    ## Sdcbp         6.019167e-05 -0.2857673 0.252 0.396 7.566694e-01
    ## Ccr5          5.879798e-05 -0.2564176 0.047 0.130 7.391494e-01
    ## Tpr           5.846679e-05 -0.3142993 0.375 0.539 7.349860e-01
    ## Zfand6        5.832365e-05 -0.2795419 0.306 0.453 7.331866e-01
    ## Cnih4         5.736059e-05 -0.2601957 0.085 0.184 7.210800e-01
    ## Arpc3         5.388926e-05 -0.2740845 0.647 0.738 6.774419e-01
    ## Mrfap1        5.060262e-05 -0.2567271 0.331 0.480 6.361256e-01
    ## Plek          4.986771e-05 -0.2620782 0.028 0.101 6.268870e-01
    ## Cytip         4.888262e-05 -0.3922063 0.454 0.586 6.145034e-01
    ## Selk          4.814083e-05 -0.2593709 0.527 0.672 6.051784e-01
    ## Ech1          4.809597e-05 -0.2555034 0.252 0.401 6.046145e-01
    ## Tmem258       4.786122e-05 -0.2798702 0.568 0.704 6.016634e-01
    ## Ndufa8        4.736609e-05 -0.2904719 0.293 0.440 5.954391e-01
    ## Ssr1          4.705325e-05 -0.2530035 0.117 0.229 5.915064e-01
    ## Edf1          4.686869e-05 -0.2808381 0.609 0.735 5.891862e-01
    ## Rhoa          4.625807e-05 -0.2719658 0.533 0.687 5.815102e-01
    ## Ppp1cc        4.556474e-05 -0.3067913 0.331 0.484 5.727944e-01
    ## Rap1b         4.546890e-05 -0.3698018 0.420 0.559 5.715896e-01
    ## Mif4gd        4.502131e-05 -0.2911768 0.139 0.260 5.659628e-01
    ## Eif4g2        4.500330e-05 -0.2832061 0.388 0.547 5.657365e-01
    ## Magoh         4.409509e-05 -0.2649698 0.186 0.317 5.543194e-01
    ## S100a6        4.319730e-05 -0.5071117 0.767 0.818 5.430332e-01
    ## Srrm1         4.171976e-05 -0.2860702 0.287 0.437 5.244591e-01
    ## Minos1        4.072273e-05 -0.2678152 0.596 0.703 5.119254e-01
    ## Cd2bp2        4.041170e-05 -0.2702674 0.076 0.171 5.080155e-01
    ## Cd40lg        3.866655e-05 -0.3880355 0.091 0.191 4.860772e-01
    ## Bax           3.807157e-05 -0.2613246 0.360 0.532 4.785977e-01
    ## Cish          3.806395e-05 -0.2624371 0.180 0.304 4.785019e-01
    ## Hist1h1e      3.722515e-05 -0.2810613 0.063 0.155 4.679573e-01
    ## Tubb4b        3.694812e-05 -0.3458442 0.110 0.218 4.644748e-01
    ## Rab8b         3.656078e-05 -0.3065000 0.322 0.481 4.596056e-01
    ## Nono          3.544352e-05 -0.2794127 0.268 0.418 4.455605e-01
    ## Ppp1cb        3.511554e-05 -0.2518809 0.126 0.243 4.414375e-01
    ## Casp8         3.383404e-05 -0.2969931 0.139 0.261 4.253277e-01
    ## Esd           3.287746e-05 -0.2713869 0.274 0.425 4.133025e-01
    ## Rpl9-ps6      3.272103e-05  0.3369353 0.716 0.652 4.113361e-01
    ## Psmb6         3.146878e-05 -0.2891933 0.328 0.489 3.955941e-01
    ## Mki67         3.131019e-05 -0.3006247 0.038 0.118 3.936004e-01
    ## Dusp1         3.117296e-05 -0.2878280 0.069 0.168 3.918753e-01
    ## Tpm3          3.041451e-05 -0.2578786 0.587 0.715 3.823408e-01
    ## Psmc4         2.981609e-05 -0.3101774 0.155 0.281 3.748181e-01
    ## Hnrnpm        2.952687e-05 -0.2544924 0.328 0.489 3.711822e-01
    ## Glmp          2.908140e-05 -0.2978763 0.161 0.288 3.655823e-01
    ## Arhgdia       2.794234e-05 -0.3015133 0.502 0.654 3.512631e-01
    ## Ppib          2.745414e-05 -0.2714885 0.536 0.680 3.451260e-01
    ## Gpx1          2.712899e-05 -0.3769033 0.252 0.390 3.410386e-01
    ## Tipin         2.702854e-05 -0.2813034 0.082 0.184 3.397757e-01
    ## Atp5o         2.501843e-05 -0.2990177 0.451 0.606 3.145067e-01
    ## Tbcb          2.471265e-05 -0.2896608 0.101 0.210 3.106627e-01
    ## Lrrc58        2.453853e-05 -0.2721286 0.095 0.204 3.084738e-01
    ## Sh3bgrl       2.446342e-05 -0.2882187 0.117 0.231 3.075297e-01
    ## Mapkapk3      2.443326e-05 -0.2687986 0.088 0.195 3.071505e-01
    ## Pkp3          2.443056e-05 -0.3420572 0.202 0.331 3.071166e-01
    ## Ccl4          2.424079e-05 -2.3937458 0.142 0.248 3.047310e-01
    ## Spcs2         2.396730e-05 -0.2787537 0.442 0.623 3.012930e-01
    ## Ppp1r11       2.395047e-05 -0.2597191 0.265 0.426 3.010814e-01
    ## Gm3839        2.390290e-05 -0.3512400 0.259 0.395 3.004833e-01
    ## Atp5a1        2.345533e-05 -0.2888854 0.420 0.570 2.948570e-01
    ## Psma6         2.327292e-05 -0.2981704 0.202 0.338 2.925638e-01
    ## Fundc2        2.321729e-05 -0.2797421 0.259 0.410 2.918646e-01
    ## Rfk           2.316536e-05 -0.2570823 0.035 0.115 2.912117e-01
    ## Gna15         2.277779e-05 -0.3056570 0.123 0.240 2.863396e-01
    ## Gm19585       2.256339e-05 -0.2957086 0.104 0.215 2.836444e-01
    ## Tspan13       2.253630e-05 -0.3544896 0.215 0.351 2.833039e-01
    ## Sar1b         2.221539e-05 -0.2814471 0.136 0.254 2.792697e-01
    ## Acsl5         2.194268e-05 -0.2839817 0.114 0.228 2.758414e-01
    ## Glipr1        2.174997e-05 -0.2879454 0.139 0.261 2.734189e-01
    ## Trappc1       2.083982e-05 -0.2534265 0.088 0.195 2.619774e-01
    ## Nfkbia        2.054845e-05 -0.5275456 0.262 0.396 2.583146e-01
    ## Ctla4         1.925894e-05 -0.3173895 0.032 0.111 2.421041e-01
    ## Frg1          1.892297e-05 -0.3433566 0.309 0.451 2.378806e-01
    ## Ndufa11       1.831970e-05 -0.3125775 0.325 0.478 2.302970e-01
    ## Mdh1          1.825479e-05 -0.2767753 0.227 0.376 2.294810e-01
    ## Rnh1          1.824716e-05 -0.3056320 0.120 0.236 2.293851e-01
    ## Camk4         1.804204e-05 -0.2537308 0.120 0.239 2.268065e-01
    ## Ezh2          1.764040e-05 -0.2898557 0.091 0.202 2.217575e-01
    ## Pigx          1.727621e-05 -0.2680332 0.126 0.246 2.171793e-01
    ## Msrb1         1.704911e-05 -0.3130064 0.114 0.232 2.143243e-01
    ## Gm9493        1.675504e-05  0.4174472 0.533 0.453 2.106275e-01
    ## Ndufb11       1.632204e-05 -0.2680325 0.492 0.655 2.051843e-01
    ## Atp5b         1.603861e-05 -0.2744559 0.615 0.750 2.016214e-01
    ## Ywhaq         1.592726e-05 -0.2500329 0.397 0.573 2.002216e-01
    ## Cd4           1.565078e-05 -0.4020228 0.120 0.232 1.967459e-01
    ## Emc8          1.561859e-05 -0.2800476 0.063 0.161 1.963412e-01
    ## Sfr1          1.553764e-05 -0.2862081 0.227 0.382 1.953236e-01
    ## Prdx4         1.551495e-05 -0.2781575 0.032 0.112 1.950384e-01
    ## Nedd8         1.525159e-05 -0.2531303 0.552 0.698 1.917278e-01
    ## Nans          1.415966e-05 -0.2798895 0.148 0.281 1.780011e-01
    ## Rps27l        1.409954e-05 -0.3979038 0.461 0.589 1.772453e-01
    ## Mcm7          1.403927e-05 -0.2648795 0.038 0.124 1.764877e-01
    ## Ctsd          1.399210e-05 -0.4851792 0.508 0.608 1.758947e-01
    ## Gm15987       1.386010e-05 -0.3349800 0.028 0.107 1.742354e-01
    ## Sh3bp5        1.380428e-05  0.4094022 0.177 0.095 1.735336e-01
    ## Nrm           1.379041e-05 -0.2724049 0.054 0.147 1.733592e-01
    ## Pdia3         1.364529e-05 -0.3458230 0.451 0.588 1.715349e-01
    ## Slc25a5       1.351439e-05 -0.3031508 0.618 0.735 1.698894e-01
    ## Ostc          1.340953e-05 -0.3150754 0.312 0.482 1.685712e-01
    ## Esyt1         1.286412e-05 -0.2795233 0.177 0.315 1.617149e-01
    ## Tmbim4        1.280804e-05 -0.2625246 0.082 0.189 1.610098e-01
    ## Lockd         1.244905e-05 -0.2966561 0.069 0.173 1.564970e-01
    ## Ndufb9        1.241957e-05 -0.2811388 0.416 0.589 1.561264e-01
    ## Ptprcap       1.209248e-05 -0.3342734 0.669 0.745 1.520145e-01
    ## Ramp3         1.207099e-05 -0.5794397 0.038 0.123 1.517445e-01
    ## Cd3e          1.192526e-05 -0.2589930 0.763 0.872 1.499124e-01
    ## Gnb2          1.052945e-05 -0.2914255 0.492 0.650 1.323657e-01
    ## 1110034G24Rik 9.700457e-06 -0.3767829 0.054 0.147 1.219444e-01
    ## Myl12b        9.583092e-06 -0.2805838 0.678 0.795 1.204690e-01
    ## Zeb2          8.749627e-06 -0.5292789 0.028 0.111 1.099916e-01
    ## Snx3          8.691777e-06 -0.2526512 0.315 0.482 1.092643e-01
    ## Hsp90b1       8.392710e-06 -0.4057087 0.429 0.567 1.055048e-01
    ## Gng2          8.253851e-06 -0.2612514 0.221 0.377 1.037592e-01
    ## Aprt          7.773219e-06 -0.3276792 0.429 0.597 9.771713e-02
    ## Litaf         7.449160e-06 -0.3119227 0.032 0.117 9.364340e-02
    ## Hspa5         7.248498e-06 -0.3617650 0.281 0.440 9.112087e-02
    ## Slamf1        7.155743e-06 -0.3129449 0.060 0.162 8.995485e-02
    ## Bcap31        6.992437e-06 -0.2907582 0.192 0.342 8.790193e-02
    ## Acp1          6.981530e-06 -0.2785641 0.088 0.201 8.776481e-02
    ## Rad21         6.648103e-06 -0.3033740 0.088 0.204 8.357330e-02
    ## Slc9a3r1      6.647556e-06 -0.2748392 0.353 0.535 8.356642e-02
    ## Psmb1         6.603463e-06 -0.2635447 0.675 0.787 8.301214e-02
    ## Gnai2         6.401817e-06 -0.2808177 0.489 0.649 8.047724e-02
    ## Il18r1        6.392871e-06 -0.5556268 0.562 0.654 8.036478e-02
    ## Bhlhe40       6.326362e-06 -0.3127491 0.161 0.301 7.952870e-02
    ## Tesc          6.056449e-06 -0.2748798 0.044 0.139 7.613562e-02
    ## Tsfm          6.039069e-06 -0.2600321 0.044 0.139 7.591714e-02
    ## Lmnb1         6.031024e-06 -0.3095495 0.035 0.123 7.581601e-02
    ## Psmb5         5.948560e-06 -0.2727512 0.243 0.408 7.477935e-02
    ## Sep15         5.784221e-06 -0.3340245 0.385 0.551 7.271345e-02
    ## Pdap1         5.555507e-06 -0.3351449 0.284 0.446 6.983828e-02
    ## Tmem167       5.235376e-06 -0.3277327 0.360 0.539 6.581391e-02
    ## Ntan1         5.183034e-06 -0.3085100 0.177 0.325 6.515592e-02
    ## Tspan32       4.778152e-06 -0.2845206 0.035 0.125 6.006615e-02
    ## Anxa1         4.710938e-06 -0.3618311 0.044 0.139 5.922120e-02
    ## Arf6          4.628873e-06 -0.3245764 0.192 0.339 5.818957e-02
    ## Ccdc12        4.444797e-06 -0.2828732 0.461 0.641 5.587554e-02
    ## Cd6           4.419486e-06 -0.3582907 0.233 0.389 5.555736e-02
    ## Psmd14        4.350789e-06 -0.2797694 0.110 0.239 5.469377e-02
    ## Tceb2         4.300387e-06 -0.2634917 0.703 0.839 5.406017e-02
    ## Ubl3          4.167849e-06 -0.3497785 0.079 0.190 5.239402e-02
    ## Lamtor5       4.160150e-06 -0.3365039 0.300 0.459 5.229725e-02
    ## Gabarap       3.986568e-06 -0.2679177 0.555 0.705 5.011515e-02
    ## Ilk           3.891426e-06 -0.2693138 0.114 0.246 4.891912e-02
    ## Ndufs5        3.882954e-06 -0.2834221 0.353 0.519 4.881261e-02
    ## Znrf1         3.770569e-06 -0.3536555 0.050 0.150 4.739983e-02
    ## Il2           3.762578e-06 -0.2839769 0.104 0.232 4.729937e-02
    ## Mrps21        3.643526e-06 -0.3241184 0.385 0.561 4.580277e-02
    ## Ak2           3.610730e-06 -0.2742057 0.129 0.266 4.539049e-02
    ## Slc25a3       3.576939e-06 -0.2765143 0.502 0.681 4.496571e-02
    ## Eva1b         3.495127e-06 -0.3725306 0.186 0.332 4.393725e-02
    ## Glrx          3.148515e-06 -0.3612945 0.192 0.338 3.957998e-02
    ## Rrm2          3.137201e-06 -0.5302923 0.019 0.100 3.943776e-02
    ## Pum2          3.117601e-06 -0.3024371 0.107 0.234 3.919136e-02
    ## Tma7          3.089147e-06 -0.2734642 0.779 0.877 3.883367e-02
    ## Sept7         3.084813e-06 -0.3146546 0.312 0.489 3.877918e-02
    ## Ubl5          2.946987e-06 -0.2874557 0.779 0.880 3.704657e-02
    ## Ube2l3        2.886709e-06 -0.3306090 0.303 0.481 3.628882e-02
    ## Sumo2         2.657379e-06 -0.2745691 0.785 0.872 3.340591e-02
    ## Psma1         2.593264e-06 -0.3347902 0.224 0.378 3.259992e-02
    ## Pttg1         2.537377e-06 -0.4828333 0.073 0.182 3.189737e-02
    ## Cst3          2.465796e-06 -0.3481991 0.268 0.438 3.099752e-02
    ## Rtn3          2.450313e-06 -0.3095056 0.158 0.304 3.080288e-02
    ## Tmed2         2.405630e-06 -0.3385433 0.341 0.510 3.024118e-02
    ## 1810037I17Rik 2.311962e-06 -0.3608488 0.451 0.629 2.906367e-02
    ## Lrrfip1       2.258151e-06 -0.3832473 0.300 0.470 2.838722e-02
    ## Ecm1          2.216154e-06 -0.9060632 0.057 0.160 2.785927e-02
    ## Kbtbd11       2.190332e-06  0.4038912 0.306 0.189 2.753466e-02
    ## AI662270      2.139126e-06 -0.4298460 0.284 0.441 2.689095e-02
    ## H2afv         2.046497e-06 -0.4804196 0.341 0.502 2.572651e-02
    ## Gltp          1.973632e-06 -0.3388361 0.211 0.368 2.481053e-02
    ## Rab11a        1.973020e-06 -0.3107993 0.145 0.289 2.480283e-02
    ## Acot7         1.909288e-06 -0.3027039 0.145 0.292 2.400166e-02
    ## Sept11        1.881307e-06 -0.3116154 0.085 0.208 2.364991e-02
    ## Tceb1         1.880973e-06 -0.3424681 0.325 0.491 2.364571e-02
    ## 1500009L16Rik 1.861051e-06 -0.3964602 0.073 0.186 2.339528e-02
    ## Sdf2l1        1.853053e-06 -0.4057141 0.155 0.288 2.329473e-02
    ## Diaph1        1.829164e-06 -0.3407969 0.101 0.228 2.299442e-02
    ## Atpif1        1.663940e-06 -0.3776556 0.246 0.405 2.091740e-02
    ## Rgs10         1.644510e-06 -0.4850683 0.262 0.411 2.067313e-02
    ## Gramd3        1.617717e-06  0.4700372 0.394 0.282 2.033632e-02
    ## Ass1          1.615094e-06 -0.4945323 0.215 0.356 2.030334e-02
    ## Wdr1          1.455228e-06 -0.3478049 0.293 0.461 1.829367e-02
    ## Pdia6         1.408384e-06 -0.3501328 0.164 0.312 1.770479e-02
    ## Cmc2          1.399061e-06 -0.2731267 0.095 0.225 1.758759e-02
    ## Cox7a2        1.365389e-06 -0.2980747 0.672 0.787 1.716431e-02
    ## Plgrkt        1.361771e-06 -0.3564344 0.136 0.277 1.711883e-02
    ## Hist1h2ap     1.314602e-06 -1.9274944 0.063 0.171 1.652586e-02
    ## Hnrnpul1      1.250624e-06 -0.3536924 0.148 0.295 1.572159e-02
    ## Asf1b         1.233617e-06 -0.3488134 0.016 0.100 1.550779e-02
    ## Capn2         1.229604e-06 -0.3476280 0.066 0.182 1.545735e-02
    ## Socs2         1.215213e-06 -0.3923117 0.073 0.189 1.527645e-02
    ## Fkbp2         1.189087e-06 -0.3813977 0.117 0.248 1.494801e-02
    ## Dynlt1c       8.911865e-07 -0.3538614 0.199 0.360 1.120311e-02
    ## Cnn2          8.793067e-07 -0.2996789 0.568 0.705 1.105376e-02
    ## Myeov2        8.440333e-07 -0.3258471 0.565 0.713 1.061034e-02
    ## Pgk1          8.258532e-07 -0.3384980 0.183 0.348 1.038180e-02
    ## Anp32a        7.984498e-07 -0.3994453 0.558 0.689 1.003731e-02
    ## Runx3         7.520837e-07  0.3737636 0.666 0.542 9.454444e-03
    ## Gmnn          6.789762e-07 -0.4063379 0.054 0.164 8.535409e-03
    ## Cenpw         6.521430e-07 -0.3023329 0.041 0.146 8.198090e-03
    ## Uqcr10        6.518043e-07 -0.3726914 0.631 0.759 8.193831e-03
    ## Arpc1b        6.318194e-07 -0.3086421 0.773 0.897 7.942602e-03
    ## Serpinb6b     6.059818e-07 -0.4472522 0.069 0.188 7.617797e-03
    ## Trac          5.984440e-07 -0.3173678 0.767 0.881 7.523039e-03
    ## Srgn          5.474680e-07 -0.3560000 0.830 0.896 6.882220e-03
    ## Sdhb          4.913228e-07 -0.3791937 0.312 0.489 6.176419e-03
    ## Ccr2          4.753066e-07 -0.5873416 0.215 0.364 5.975080e-03
    ## Klrg1         4.655373e-07 -0.4579167 0.016 0.106 5.852269e-03
    ## Plp2          4.559245e-07 -0.3890469 0.142 0.289 5.731427e-03
    ## Cmpk1         4.547404e-07 -0.3205926 0.177 0.340 5.716542e-03
    ## Atp5c1        4.516372e-07 -0.3512155 0.558 0.703 5.677532e-03
    ## Mcm5          4.437082e-07 -0.2925450 0.019 0.112 5.577856e-03
    ## Whsc1l1       4.402347e-07  0.4053016 0.577 0.468 5.534191e-03
    ## Gm10282       3.951818e-07 -0.3612711 0.022 0.118 4.967831e-03
    ## Rhof          3.881143e-07 -0.3897075 0.139 0.288 4.878985e-03
    ## Cks2          3.827529e-07 -0.5201759 0.129 0.268 4.811587e-03
    ## Tnfrsf4       3.781357e-07 -0.7733893 0.202 0.346 4.753544e-03
    ## Slbp          3.582160e-07 -0.4158938 0.161 0.313 4.503134e-03
    ## Ms4a4c        3.338835e-07  0.3918860 0.161 0.071 4.197250e-03
    ## Tpm4          3.334536e-07 -0.3773676 0.233 0.410 4.191846e-03
    ## Calm3         3.254948e-07 -0.3603315 0.347 0.527 4.091795e-03
    ## Lsp1          3.129951e-07 -0.3799031 0.603 0.746 3.934661e-03
    ## Ramp1         3.051676e-07 -0.4884803 0.123 0.266 3.836262e-03
    ## Mapre1        2.991578e-07 -0.3313177 0.208 0.386 3.760713e-03
    ## Lig1          2.755877e-07 -0.4229957 0.054 0.171 3.464413e-03
    ## Trbc2         2.692087e-07 -0.3034998 0.931 0.971 3.384222e-03
    ## Cenpa         2.642172e-07 -0.6482063 0.082 0.210 3.321475e-03
    ## Cdc42         2.362919e-07 -0.3314034 0.685 0.816 2.970425e-03
    ## Atp5l         2.277217e-07 -0.2929588 0.833 0.920 2.862690e-03
    ## Npm1          2.216326e-07  0.2981884 0.924 0.895 2.786144e-03
    ## Gm2000        2.130540e-07  0.3008063 0.896 0.881 2.678302e-03
    ## Ctla2a        1.888494e-07 -0.5415182 0.338 0.494 2.374026e-03
    ## Psma2         1.662368e-07 -0.3838205 0.413 0.601 2.089763e-03
    ## Atp5f1        1.527116e-07 -0.3647887 0.502 0.671 1.919738e-03
    ## Cd44          1.437443e-07 -0.3890025 0.114 0.261 1.807009e-03
    ## Mpc1          1.269538e-07 -0.3785480 0.180 0.346 1.595937e-03
    ## AA467197      1.160525e-07 -0.7073257 0.079 0.209 1.458896e-03
    ## Cox6c         1.137929e-07 -0.2840713 0.845 0.905 1.430491e-03
    ## Tspo          1.133394e-07 -0.3482061 0.612 0.778 1.424790e-03
    ## Ucp2          1.042137e-07 -0.4067820 0.590 0.732 1.310070e-03
    ## Tpi1          1.028909e-07 -0.5049202 0.262 0.442 1.293442e-03
    ## Vasp          8.725845e-08 -0.3723683 0.562 0.739 1.096926e-03
    ## Tmbim6        7.658240e-08 -0.4007563 0.498 0.662 9.627174e-04
    ## Bin1          6.840354e-08 -0.3993740 0.136 0.296 8.599009e-04
    ## Cd2           5.623395e-08 -0.4497208 0.571 0.714 7.069170e-04
    ## Spc24         5.387820e-08 -0.3378256 0.013 0.112 6.773029e-04
    ## Aldoa         4.643561e-08 -0.4284703 0.767 0.846 5.837421e-04
    ## Cox5a         4.397525e-08 -0.3965285 0.606 0.748 5.528129e-04
    ## Lag3          4.378900e-08 -0.4939503 0.038 0.156 5.504715e-04
    ## Aip           4.257392e-08 -0.3356613 0.101 0.257 5.351968e-04
    ## Eef1b2        3.336307e-08  0.2975660 0.934 0.889 4.194072e-04
    ## Ap2s1         3.276826e-08 -0.3946276 0.240 0.428 4.119298e-04
    ## Xbp1          3.244821e-08 -0.5585053 0.098 0.245 4.079065e-04
    ## Ndufb7        3.095166e-08 -0.4097746 0.508 0.675 3.890933e-04
    ## Prelid1       2.514249e-08 -0.4178634 0.426 0.623 3.160663e-04
    ## Ebp           2.467055e-08 -0.3855928 0.148 0.322 3.101335e-04
    ## Rora          2.188344e-08 -0.4673724 0.104 0.258 2.750967e-04
    ## Dbi           2.146356e-08 -0.4356515 0.215 0.399 2.698184e-04
    ## Tceb3         1.674997e-08 -0.3667990 0.032 0.153 2.105638e-04
    ## Eif4e2        1.497357e-08 -0.4084369 0.186 0.368 1.882328e-04
    ## Birc5         1.430627e-08 -0.6566773 0.025 0.139 1.798441e-04
    ## Gdi2          1.079861e-08 -0.4760703 0.429 0.611 1.357493e-04
    ## Canx          1.002046e-08 -0.4302564 0.180 0.363 1.259672e-04
    ## Manf          9.090628e-09 -0.4544715 0.268 0.461 1.142783e-04
    ## Prdx1         9.046712e-09 -0.4305615 0.511 0.679 1.137262e-04
    ## Shfm1         7.961640e-09 -0.3515660 0.735 0.849 1.000858e-04
    ## Vamp8         7.572907e-09 -0.3761264 0.372 0.595 9.519902e-05
    ## Actb          7.376379e-09 -0.5152272 0.987 0.999 9.272846e-05
    ## Ube2c         7.317595e-09 -0.5151485 0.003 0.104 9.198949e-05
    ## Atox1         6.976301e-09 -0.4339153 0.420 0.616 8.769908e-05
    ## Esm1          6.659242e-09 -0.6216330 0.044 0.175 8.371333e-05
    ## Rgs1          5.954774e-09 -0.6999416 0.256 0.432 7.485746e-05
    ## Tm9sf3        5.894970e-09 -0.4389472 0.098 0.259 7.410567e-05
    ## Eef1g         5.770887e-09  0.3130331 0.893 0.882 7.254582e-05
    ## Rac2          4.139448e-09 -0.2831960 0.975 0.976 5.203701e-05
    ## Rbx1          3.874174e-09 -0.3869196 0.486 0.687 4.870225e-05
    ## Dapl1         3.665931e-09  0.6328763 0.126 0.039 4.608442e-05
    ## Icos          3.176218e-09 -0.5119245 0.167 0.354 3.992824e-05
    ## Hnrnpa3       3.122673e-09 -0.4641655 0.536 0.716 3.925512e-05
    ## Eno1          3.023532e-09 -0.4083928 0.700 0.848 3.800882e-05
    ## Aurkaip1      2.982801e-09 -0.4128947 0.309 0.518 3.749679e-05
    ## Cd47          2.930524e-09 -0.4303596 0.669 0.818 3.683962e-05
    ## Fkbp1a        2.703849e-09 -0.4674278 0.521 0.707 3.399008e-05
    ## Hmgb1         2.663459e-09 -0.4529105 0.776 0.872 3.348234e-05
    ## Ccnb2         2.649470e-09 -0.4905376 0.006 0.117 3.330649e-05
    ## Dok2          2.647615e-09 -0.4507214 0.369 0.583 3.328317e-05
    ## Rap1a         2.556958e-09 -0.4499837 0.369 0.579 3.214352e-05
    ## Rpl22l1       2.480133e-09  0.3206401 0.959 0.958 3.117775e-05
    ## Rbm3          2.382961e-09 -0.4210142 0.770 0.839 2.995620e-05
    ## Tecr          2.315977e-09 -0.4009249 0.227 0.436 2.911414e-05
    ## Rps18-ps3     2.282890e-09  0.3868988 0.855 0.816 2.869821e-05
    ## Arf5          1.884027e-09 -0.4362781 0.558 0.761 2.368410e-05
    ## Cox4i1        1.225679e-09 -0.3264030 0.871 0.940 1.540801e-05
    ## H2afz         1.212586e-09 -0.7821753 0.722 0.829 1.524341e-05
    ## Krtcap2       1.210420e-09 -0.3927662 0.621 0.807 1.521620e-05
    ## H3f3a         1.106911e-09 -0.3644859 0.779 0.883 1.391498e-05
    ## Crip1         9.038256e-10 -0.6551082 0.905 0.924 1.136199e-05
    ## Hmgn2         8.932287e-10 -0.9385446 0.180 0.348 1.122878e-05
    ## H3f3b         8.135140e-10 -0.3124022 0.924 0.975 1.022668e-05
    ## Ctsb          8.077753e-10 -0.4524733 0.164 0.364 1.015454e-05
    ## Ywhah         7.178600e-10 -0.5288683 0.306 0.508 9.024219e-06
    ## Cap1          6.824091e-10 -0.4511302 0.416 0.636 8.578565e-06
    ## Cox5b         6.697144e-10 -0.4181745 0.640 0.762 8.418980e-06
    ## Pycard        6.325494e-10 -0.5740137 0.322 0.513 7.951778e-06
    ## Ppp1ca        5.820193e-10 -0.3872685 0.707 0.829 7.316565e-06
    ## Txn1          4.530916e-10 -0.4743461 0.555 0.727 5.695814e-06
    ## Lsm6          4.491708e-10 -0.4809223 0.249 0.459 5.646526e-06
    ## Tmem14c       3.951148e-10 -0.4421349 0.211 0.422 4.966989e-06
    ## Tomm22        3.468537e-10 -0.4216004 0.315 0.539 4.360298e-06
    ## Fth1          3.263047e-10 -0.3027816 0.962 0.990 4.101976e-06
    ## Hcls1         3.190401e-10 -0.4624704 0.170 0.374 4.010653e-06
    ## Tnfrsf9       2.961400e-10 -0.9721409 0.085 0.248 3.722776e-06
    ## Samsn1        2.658715e-10 -0.5838241 0.205 0.410 3.342271e-06
    ## Cox6b1        2.281865e-10 -0.3601999 0.798 0.869 2.868533e-06
    ## Prr13         2.213158e-10 -0.4897346 0.565 0.740 2.782161e-06
    ## Atp5j2        2.170815e-10 -0.4026649 0.726 0.847 2.728932e-06
    ## Atp5j         2.034880e-10 -0.4135242 0.625 0.777 2.558047e-06
    ## Rpl5          1.438898e-10  0.3445497 0.934 0.913 1.808839e-06
    ## Fabp5         1.353494e-10 -0.6777291 0.038 0.187 1.701477e-06
    ## Ldha          9.942977e-11 -0.4359699 0.694 0.852 1.249932e-06
    ## Arl6ip1       8.294214e-11 -0.5611511 0.483 0.683 1.042666e-06
    ## Ly6c2         7.810411e-11  0.3932528 0.697 0.460 9.818468e-07
    ## Cotl1         7.667122e-11 -0.4462964 0.738 0.845 9.638339e-07
    ## Dap           5.262736e-11 -0.5657911 0.164 0.368 6.615785e-07
    ## Rps17         5.152097e-11  0.3008209 0.994 0.970 6.476701e-07
    ## Smdt1         4.909444e-11 -0.5249504 0.394 0.632 6.171663e-07
    ## Cks1b         4.525505e-11 -0.6810285 0.022 0.164 5.689013e-07
    ## Rpl13-ps3     3.898759e-11  0.4609140 0.785 0.686 4.901131e-07
    ## 2810417H13Rik 3.345625e-11 -1.1248119 0.032 0.181 4.205785e-07
    ## Atp5k         2.597918e-11 -0.4886984 0.577 0.760 3.265842e-07
    ## Gzma          2.189756e-11 -2.4295159 0.047 0.204 2.752742e-07
    ## Serf2         2.016669e-11 -0.3061518 0.946 0.979 2.535154e-07
    ## Maf           1.424761e-11 -0.9110438 0.107 0.293 1.791067e-07
    ## Arpc5         1.278127e-11 -0.4858965 0.587 0.755 1.606734e-07
    ## Sub1          7.848199e-12 -0.4143967 0.852 0.925 9.865971e-08
    ## Cxcr6         6.877542e-12 -0.7617709 0.306 0.513 8.645759e-08
    ## Arpc4         6.643133e-12 -0.4940498 0.467 0.683 8.351082e-08
    ## Psmb7         5.621614e-12 -0.5066630 0.139 0.349 7.066931e-08
    ## Ly6c1         5.338400e-12  0.4533630 0.659 0.414 6.710903e-08
    ## 5430421N21Rik 5.182036e-12 -1.0687696 0.028 0.183 6.514338e-08
    ## Cox17         3.980814e-12 -0.4823804 0.697 0.836 5.004282e-08
    ## Anxa2         3.035973e-12 -0.7323223 0.224 0.444 3.816521e-08
    ## Gapdh         2.840974e-12 -0.4573177 0.868 0.930 3.571388e-08
    ## Actr3         2.156797e-12 -0.5413188 0.644 0.792 2.711310e-08
    ## Rps2          2.008634e-12  0.3051547 1.000 0.988 2.525053e-08
    ## Ppia          5.232234e-13 -0.3557701 0.997 0.997 6.577441e-09
    ## Rpl3          3.175521e-13  0.2640552 0.997 0.996 3.991948e-09
    ## Cyba          2.556677e-13 -0.4877522 0.751 0.883 3.213998e-09
    ## Cd48          2.327722e-13 -0.6551176 0.410 0.631 2.926179e-09
    ## Stmn1         2.072979e-13 -1.2872349 0.060 0.243 2.605942e-09
    ## Capzb         1.548697e-13 -0.5393368 0.435 0.673 1.946867e-09
    ## Rpsa          9.780101e-14  0.2722108 1.000 0.994 1.229457e-09
    ## Rpl22         6.374330e-14  0.2959393 0.987 0.980 8.013170e-10
    ## Rpl18         6.309767e-14  0.2603111 1.000 0.996 7.932009e-10
    ## Tmem176a      3.684893e-14 -1.0861157 0.022 0.196 4.632279e-10
    ## Myl12a        3.074737e-14 -0.4834460 0.729 0.846 3.865252e-10
    ## S100a13       2.819467e-14 -0.5730227 0.656 0.805 3.544351e-10
    ## Id2           2.071736e-14 -0.7433723 0.751 0.844 2.604379e-10
    ## Bcl2a1b       1.556688e-14 -0.7238484 0.237 0.491 1.956913e-10
    ## Rps20         1.027084e-14  0.2940350 0.997 0.994 1.291147e-10
    ## Coro1a        3.607778e-15 -0.4544955 0.918 0.951 4.535338e-11
    ## Tmem176b      2.206764e-15 -1.2807751 0.032 0.223 2.774123e-11
    ## Rpl35         1.789361e-15  0.2845726 1.000 0.999 2.249406e-11
    ## Pkm           1.700842e-15 -0.6007052 0.521 0.761 2.138129e-11
    ## Calm1         1.699824e-15 -0.5210706 0.855 0.911 2.136849e-11
    ## Gzmb          1.590027e-15 -1.6137995 0.202 0.432 1.998823e-11
    ## Reep5         1.413499e-15 -0.6606240 0.429 0.675 1.776909e-11
    ## Dynll1        8.775989e-16 -0.6047261 0.593 0.802 1.103230e-11
    ## Rpl23a-ps3    7.801877e-16  0.4048041 0.962 0.939 9.807739e-12
    ## Abracl        5.707151e-16 -0.5980478 0.574 0.762 7.174459e-12
    ## S100a10       4.279605e-16 -0.5890204 0.890 0.945 5.379891e-12
    ## Rpl26         3.360676e-16  0.2831017 1.000 0.993 4.224706e-12
    ## Arpc2         3.313304e-16 -0.4607530 0.845 0.939 4.165155e-12
    ## Gm10073       3.121501e-16  0.4342929 0.981 0.930 3.924040e-12
    ## Arhgdib       1.636185e-16 -0.4636476 0.899 0.969 2.056848e-12
    ## Oaz1          1.129976e-16 -0.3833997 0.950 0.977 1.420493e-12
    ## Cmtm7         3.496540e-17 -0.7902139 0.218 0.489 4.395500e-13
    ## Cd3g          5.192816e-18 -0.4764610 0.934 0.965 6.527890e-14
    ## Bcl2a1d       4.353236e-18 -0.8446907 0.148 0.420 5.472453e-14
    ## Capg          4.018060e-18 -0.9618696 0.271 0.532 5.051103e-14
    ## Rpl11         2.956724e-18  0.2572486 1.000 1.000 3.716898e-14
    ## Rps6          2.516245e-18  0.2661914 1.000 0.998 3.163171e-14
    ## Hmgb2         2.242701e-18 -1.3849710 0.615 0.791 2.819300e-14
    ## S100a11       2.183718e-18 -0.6894734 0.666 0.842 2.745152e-14
    ## Rps8          3.280382e-19  0.3057860 1.000 0.998 4.123768e-15
    ## Clic1         1.966702e-19 -0.5851532 0.738 0.869 2.472342e-15
    ## Rps10         1.907237e-19  0.2652730 1.000 1.000 2.397587e-15
    ## Rps3a1        8.423173e-20  0.2884295 1.000 0.998 1.058877e-15
    ## Rpl30         2.896071e-20  0.3325075 1.000 0.995 3.640651e-16
    ## Lgals3        1.832408e-21 -1.2060072 0.366 0.633 2.303520e-17
    ## Rpl21         1.058274e-21  0.3008474 1.000 0.999 1.330356e-17
    ## Rps25         9.456879e-22  0.3655947 0.997 0.994 1.188824e-17
    ## Rps13         5.323223e-22  0.2737230 1.000 0.998 6.691823e-18
    ## Cd52          4.860957e-22 -0.6340114 0.978 0.981 6.110709e-18
    ## S100a4        4.347803e-22 -1.1495633 0.429 0.681 5.465623e-18
    ## Rpl10a        3.294503e-22  0.3719128 0.997 0.995 4.141520e-18
    ## Rps4x         1.481745e-22  0.3056754 1.000 1.000 1.862702e-18
    ## Cfl1          6.986870e-23 -0.5520035 0.927 0.978 8.783194e-19
    ## Myl6          2.870099e-23 -0.5339849 0.934 0.967 3.608001e-19
    ## Rps3          6.751439e-24  0.2958519 1.000 1.000 8.487235e-20
    ## Rpl14         4.077660e-24  0.3460147 1.000 0.998 5.126027e-20
    ## Rps15         4.699058e-25  0.3274389 1.000 0.996 5.907186e-21
    ## Itm2b         2.754468e-25 -0.6491625 0.820 0.937 3.462642e-21
    ## Rpl23         2.695804e-25  0.3267101 1.000 0.999 3.388895e-21
    ## Wdr89         1.439101e-25  0.3465336 1.000 0.994 1.809094e-21
    ## Rpl35a        4.630028e-26  0.3211179 1.000 1.000 5.820408e-22
    ## Rpl27a        4.545220e-26  0.3072729 1.000 1.000 5.713796e-22
    ## Rpl8          1.189438e-26  0.3449251 1.000 0.998 1.495243e-22
    ## Rps9          4.413319e-27  0.3588709 0.997 0.998 5.547984e-23
    ## Rpl12         4.019062e-27  0.4635757 0.997 0.989 5.052363e-23
    ## Rpl36a        1.038143e-27  0.4980877 0.997 0.989 1.305050e-23
    ## Vim           8.273357e-28 -0.9493114 0.634 0.844 1.040044e-23
    ## Bcl2          2.175929e-28  0.8085540 0.855 0.608 2.735360e-24
    ## Rpl37a        4.111535e-29  0.2878141 1.000 1.000 5.168610e-25
    ## Rps27a        2.366857e-29  0.3198383 1.000 1.000 2.975376e-25
    ## Rps19         1.503347e-30  0.4058360 1.000 0.998 1.889857e-26
    ## Rpl23a        5.859878e-31  0.3649396 1.000 1.000 7.366453e-27
    ## Rps21         2.265237e-31  0.4080082 1.000 0.997 2.847630e-27
    ## Actg1         9.605688e-33 -0.6884719 0.968 0.990 1.207531e-28
    ## Rpl9          2.664970e-33  0.3570013 1.000 0.999 3.350133e-29
    ## Rps23         1.580404e-33  0.3342624 1.000 1.000 1.986726e-29
    ## Rpl39         1.341113e-33  0.3432189 1.000 1.000 1.685913e-29
    ## Pfn1          5.578605e-34 -0.5990044 0.994 0.998 7.012865e-30
    ## Sh3bgrl3      5.000605e-34 -0.7226867 0.890 0.957 6.286261e-30
    ## Rpl37         8.853567e-35  0.3573651 1.000 1.000 1.112982e-30
    ## Rpl32         3.198932e-35  0.3616044 1.000 0.999 4.021378e-31
    ## Rplp2         6.835206e-36  0.3326655 1.000 1.000 8.592538e-32
    ## Rpl17         1.237723e-37  0.3501896 1.000 1.000 1.555942e-33
    ## Rplp1         1.489334e-38  0.4065791 1.000 0.998 1.872241e-34
    ## Rpl36         6.374060e-39  0.4173315 1.000 0.999 8.012831e-35
    ## Rps7          2.953424e-39  0.3994527 1.000 0.999 3.712749e-35
    ## Rps5          2.895245e-39  0.4119896 1.000 0.999 3.639613e-35
    ## Rpl18a        2.061588e-39  0.3610671 1.000 1.000 2.591622e-35
    ## Rpl13         9.295001e-41  0.4163408 1.000 1.000 1.168475e-36
    ## Tmsb4x        2.337482e-42 -0.4685040 1.000 1.000 2.938449e-38
    ## Gm10260       3.618803e-44  0.5046848 1.000 0.994 4.549197e-40
    ## Rps29         1.585429e-44  0.3956988 1.000 1.000 1.993043e-40
    ## Rpl38         1.202779e-44  0.4240007 1.000 1.000 1.512014e-40
    ## Rps27rt       8.884549e-46  0.5063820 1.000 0.996 1.116877e-41
    ## Rps16         2.194739e-47  0.4082726 1.000 1.000 2.759006e-43
    ## Rps24         4.863138e-54  0.4333451 1.000 1.000 6.113451e-50
    ## Rps18         3.784026e-56  0.5044179 1.000 1.000 4.756899e-52
    ## Lgals1        1.306425e-56 -1.4472011 0.817 0.959 1.642307e-52
    ## Rps27         2.316598e-68  0.4939912 1.000 1.000 2.912196e-64
    ## Rps28         3.679618e-70  0.5631877 1.000 0.999 4.625647e-66

``` r
# Select the gene Nkg7
sel.gene <- "Nkg7"

# extract scaled expression values
expr.0 <- GetAssayData(object = tem.0, slot = "scale.data")
expr.else <- GetAssayData(object = tem.else, slot = "scale.data")

# Extract expression values for the gene
expr.0.sel <- expr.0[rownames(expr.0) == sel.gene,]
expr.else.sel <- expr.0[rownames(expr.else) == sel.gene,]

# Perform the Wilcoxon Rank Sum test 
wilcox.test(x = expr.0.sel, 
            y = expr.else.sel, alternative = "two.sided")
```

    ## 
    ##  Wilcoxon rank sum test with continuity correction
    ## 
    ## data:  expr.0.sel and expr.else.sel
    ## W = 50244, p-value = 1
    ## alternative hypothesis: true location shift is not equal to 0

``` r
# W = 50244, p-value = 1

cluster0.markers %>%
  rownames_to_column(var = "gene_name") %>%
  filter(gene_name == sel.gene)
```

    ##   gene_name     p_val avg_log2FC pct.1 pct.2 p_val_adj
    ## 1      Nkg7 0.5104688 -0.2809875 0.924 0.716         1

``` r
# p-value = 0.51
```

### Run FindMakers() for each cluster

``` r
all.markers <- FindAllMarkers(tem)
```

Show the top 5 up-regulated genes in each cluster

``` r
all.markers %>%
  group_by(cluster) %>%
  slice_max(n = 3, order_by = avg_log2FC) %>%
  arrange(cluster, -avg_log2FC)
```

    ## # A tibble: 18 × 7
    ## # Groups:   cluster [6]
    ##        p_val avg_log2FC pct.1 pct.2 p_val_adj cluster gene         
    ##        <dbl>      <dbl> <dbl> <dbl>     <dbl> <fct>   <chr>        
    ##  1 2.18e- 28      0.809 0.855 0.608 2.74e- 24 0       Bcl2         
    ##  2 3.67e-  9      0.633 0.126 0.039 4.61e-  5 0       Dapl1        
    ##  3 3.68e- 70      0.563 1     0.999 4.63e- 66 0       Rps28        
    ##  4 1.07e- 69      2.92  0.677 0.217 1.35e- 65 1       Ifitm1       
    ##  5 9.69e- 66      2.12  0.738 0.274 1.22e- 61 1       Ifitm2       
    ##  6 4.57e- 50      1.67  0.571 0.174 5.75e- 46 1       Ifitm3       
    ##  7 1.03e- 72      3.17  0.517 0.085 1.30e- 68 2       Gzma         
    ##  8 1.48e- 58      1.98  0.969 0.752 1.86e- 54 2       Ccl5         
    ##  9 4.01e- 43      1.90  0.692 0.306 5.04e- 39 2       Gzmb         
    ## 10 1.19e-156      2.55  0.711 0.053 1.49e-152 3       Tmem176b     
    ## 11 2.97e- 68      2.39  0.444 0.063 3.73e- 64 3       Ecm1         
    ## 12 8.58e-132      2.25  0.62  0.046 1.08e-127 3       Tmem176a     
    ## 13 1.12e- 65      4.23  0.58  0.093 1.41e- 61 4       Hist1h2ap    
    ## 14 8.88e-174      3.09  0.858 0.059 1.12e-169 4       2810417H13Rik
    ## 15 4.14e-148      3.00  0.914 0.114 5.21e-144 4       Stmn1        
    ## 16 4.12e- 16      2.36  0.509 0.201 5.18e- 12 5       Ccl4         
    ## 17 3.45e- 27      2.32  0.298 0.042 4.33e- 23 5       Ccl3         
    ## 18 1.25e- 95      1.94  0.544 0.03  1.57e- 91 5       Tcrg-C2

``` r
# note that this uses slice_max() and avg_log2FC is arranged from high to low with "-"
```

Show the top 5 down-regulated genes in each cluster

``` r
all.markers %>%
  group_by(cluster) %>%
  slice_min(n = 3, order_by = avg_log2FC) %>%
  arrange(cluster, avg_log2FC)
```

    ## # A tibble: 18 × 7
    ## # Groups:   cluster [6]
    ##        p_val avg_log2FC pct.1 pct.2 p_val_adj cluster gene     
    ##        <dbl>      <dbl> <dbl> <dbl>     <dbl> <fct>   <chr>    
    ##  1 2.19e- 11      -2.43 0.047 0.204 2.75e-  7 0       Gzma     
    ##  2 2.42e-  5      -2.39 0.142 0.248 3.05e-  1 0       Ccl4     
    ##  3 1.31e-  6      -1.93 0.063 0.171 1.65e-  2 0       Hist1h2ap
    ##  4 1.76e-  6      -1.86 0.082 0.193 2.22e-  2 1       Gzma     
    ##  5 1.05e-  3      -1.81 0.088 0.163 1   e+  0 1       Hist1h2ap
    ##  6 2.10e-  9      -1.19 0.031 0.164 2.64e-  5 1       Ecm1     
    ##  7 1.92e-  6      -1.85 0.217 0.332 2.41e-  2 2       Ifitm1   
    ##  8 1.40e- 11      -1.41 0.206 0.407 1.75e-  7 2       Ifitm2   
    ##  9 1.24e- 12      -1.18 0.038 0.216 1.56e-  8 2       Tmem176b 
    ## 10 4.81e- 81      -5.22 0.454 0.877 6.04e- 77 3       Ccl5     
    ## 11 7.54e- 20      -3.49 0.095 0.361 9.48e- 16 3       Ifitm1   
    ## 12 1.20e-112      -3.43 0.165 0.905 1.51e-108 3       Nkg7     
    ## 13 1.45e-  4      -2.37 0.21  0.322 1   e+  0 4       Ifitm1   
    ## 14 3.88e- 17      -1.78 0.673 0.81  4.87e- 13 4       Ccl5     
    ## 15 8.65e- 30      -1.70 0.29  0.708 1.09e- 25 4       Bcl2     
    ## 16 1.10e- 11      -1.84 0.219 0.536 1.38e-  7 5       Ly6c2    
    ## 17 3.51e- 10      -1.73 0.211 0.489 4.41e-  6 5       Ly6c1    
    ## 18 5.67e- 17      -1.54 0.114 0.511 7.13e- 13 5       Emb

``` r
# note that this uses slice_min() and avg_log2FC is arranged from low to high
```

Visualize the top 5 up- and down-regulated genes in a heatmap

``` r
all.markers %>%
    group_by(cluster) %>%
    slice_max(n = 5, order_by = avg_log2FC) -> upGenes
all.markers %>%
    group_by(cluster) %>%
    slice_min(n = 5, order_by = avg_log2FC) -> downGenes
upGenes %>%
  bind_rows(downGenes) -> topGenes

DoHeatmap(tem, features = topGenes$gene)
```

![](5_de_files/figure-markdown_github/unnamed-chunk-9-1.png)

``` r
# Clusters 0, 1, 2 correspond to p1?
# Cluster 3 corresponds to p2?
# Cluster 4 corresponds to p3?
# Cluster 5 corresponds to p4?
```

Investigate specific genes by overlaying gene expression on top of the
tSNE plot as in the Fig2 B-D plots (page 5)

``` r
# remember this visualization tool from above too
plot_grid(DimPlot(tem, reduction = "tsne"),
          FeaturePlot(tem, features = c("Hmgb2")))
```

![](5_de_files/figure-markdown_github/unnamed-chunk-10-1.png)

Investigate specific genes by generating violin plots. By default, the
“expression level” is based on values in the “data” slot. Alternatively,
you can plot counts from the “counts” slot instead.

``` r
VlnPlot(tem, features = c("Hmgb2"), split.by = "seurat_clusters")
```

![](5_de_files/figure-markdown_github/unnamed-chunk-11-1.png)

``` r
# you can plot raw counts as well
VlnPlot(tem, features = c("Hmgb2"), slot = "counts")
```

![](5_de_files/figure-markdown_github/unnamed-chunk-11-2.png)

``` r
VlnPlot(tem, features = c("Hmgb2"), slot = "counts", log = TRUE)
```

![](5_de_files/figure-markdown_github/unnamed-chunk-11-3.png)

## 2. Re-name clusters

Name clusters based on biomarkers and study aims (Fig 2)

I **think** the authors decided to assign the following names to these
clusters, see *RESULTS, scRNA-seq dissects intratumoral TEff/EM
heterogeneity, page 4-5*:

p1 = Clusters 0, 1, 2 p2 = Cluster 3 p3 = Cluster 4 p4 = Cluster 5

We can add this information to the tem seurat object metadata

``` r
new.cluster.ids <- c("p1", "p1", "p1", 
                     "p2", 
                     "p3", 
                     "p4")
levels(tem)
```

    ## [1] "0" "1" "2" "3" "4" "5"

``` r
names(new.cluster.ids) <- levels(tem)
tem <- RenameIdents(tem, new.cluster.ids)
```

Based on these updated classifications, we can re-color the tSNE plot

``` r
DimPlot(tem, reduction = "tsne", label = TRUE, pt.size = 0.5)
```

![](5_de_files/figure-markdown_github/unnamed-chunk-13-1.png)

We can also perform DE analyses between p4 and p2.

``` r
p4v2markers <- FindMarkers(tem, ident.1 = "p4", ident.2 = "p2", min.pct = 0.25)
```

Examine up-regulated genes in p4 as compared to p2

``` r
p4v2markers %>%
  slice_max(n = 5, order_by = avg_log2FC) %>%
  arrange(-avg_log2FC) -> upGenes
upGenes
```

    ##              p_val avg_log2FC pct.1 pct.2    p_val_adj
    ## Ccl4  5.609616e-27   4.536436 0.509 0.056 7.051849e-23
    ## Ccl5  3.026007e-26   4.296344 0.912 0.454 3.803994e-22
    ## Nkg7  8.890317e-68   4.180627 1.000 0.165 1.117602e-63
    ## Klrc1 1.905160e-72   3.487166 0.921 0.025 2.394977e-68
    ## Cd8b1 2.345653e-69   3.284825 0.965 0.077 2.948720e-65

Examine down-regulated genes in p4 as compared to p2

``` r
p4v2markers %>%
  slice_min(n = 5, order_by = avg_log2FC) %>%
  arrange(avg_log2FC) -> downGenes
downGenes
```

    ##                      p_val avg_log2FC pct.1 pct.2    p_val_adj
    ## Tmem176b      2.523090e-31  -2.738166 0.026 0.711 3.171776e-27
    ## Ecm1          5.138250e-13  -2.473402 0.088 0.444 6.459294e-09
    ## Tmem176a      1.071210e-25  -2.401155 0.018 0.620 1.346618e-21
    ## 5430421N21Rik 5.562011e-16  -2.269368 0.061 0.479 6.992004e-12
    ## Emb           2.325136e-24  -2.195173 0.114 0.662 2.922929e-20

## 3. Verify manuscript DE results

#### Are these statements true from *RESULTS, scRNA-seq dissects intratumoral TEff/EM heterogeneity, page 4-5*?

1.  “The effector molecules Ifng and GzmB were highly expressed in p4,
    had heterogeneous expression in p1 and p3, but were largely absent
    from p2. Similar expression patterns were applied to well-known
    effector surface markers for cytolytic T cells such as Klrc1 and
    Nkg7 (Figure 2B).”

2.  “All four subsets highly expressed the transcription factor Runx3…,
    as well as Id2…”

3.  “Comparing p2 to p4, the density of Runx3- and Id2-expressing cells
    was slightly lower in p2. …This was accompanied by an opposite
    pattern of Id3, a transcription factor whose expression is crucial
    for effector memory development (Yang et al., 2011), which is absent
    in p4 (Figure 2C).”

4.  “Bcl2, a transcription factor for T cell survival in the effector
    and memory phases, was abundant in most sorted TEff/EM populations
    except p3.”

5.  “After assessing the cell-cycle programs, we determined that p3 was
    a highly proliferative subset, as made evident by the expression of
    genes restrictively expressed in S and M phases, such as Ccnb2,
    Cdk1, and Mki67 (Figure 2D).

#### Are these statements true from *RESULTS, Tumor and distant mucosa TRMs comprise two distinct populations that resemble either TEMs or TCMs, page 5-6*?

1.  “As expected, the tumor and distant mucosa TRM populations showed
    high expression of Itgae (CD103) and low expression of S1PR1, con-
    firming their tendency to reside within the tissue (Figure S4).”

2.  “Notably, the binary expression of Lgals3 (galectin-3) could
    distinguish TEMs (p1 of TEff/EM) from TCMs.”

#### Are these statements true from *RESULTS, CXCR6 expression defines a unique subpopulation of TEff/EMs, page 9*?

1.  ” Among all of the TEff/EM populations, S1pr1 expression was
    silenced in TEff/EM p4, suggesting that this may be a population
    that lacks the potential to egress.”

2.  “In p4, compared to other chemokine receptors, Cxcr6 was highly
    expressed; compared to the other 3 populations, p4 was the only
    population that preferentially upregulated Cxcr6 (Figure 5A).”

3.  “The elevated Cxcr6 expression in p4 was associated with enhanced
    Pdcd1 and reduced IL7r expression, in direct opposition to p2
    (Figure 5B).”

``` r
p4v2markers %>%
  rownames_to_column(var = "gene") %>%
  filter(gene == "Pdcd1")
```

    ##    gene        p_val avg_log2FC pct.1 pct.2    p_val_adj
    ## 1 Pdcd1 1.595608e-45   1.888853 0.807 0.088 2.005839e-41

``` r
p4v2markers %>%
  rownames_to_column(var = "gene") %>%
  filter(gene %in% c("Il7r","Il18r1"))
```

    ##     gene        p_val avg_log2FC pct.1 pct.2    p_val_adj
    ## 1 Il18r1 1.985300e-28  -2.118871 0.386 0.845 2.495720e-24
    ## 2   Il7r 1.512968e-24  -2.024693 0.325 0.757 1.901952e-20

1.  “We virtually sorted out these two populations of cells \[p2 vs p4\]
    and compared their gene expression at the transcriptomic level
    (Figure 5C). The differential expression of Nkg7 and Klrc/d family
    members suggested that these are highly active effector T cells, as
    seen in the high expression of effector molecules such as Gzmb.” And
    from Fig 5 legend: “T cell activation markers Gzmb, Klrc1/2, and
    Klrd1 are upregulated in TEFF/TEM p4”.

``` r
p4v2markers %>%
  rownames_to_column(var = "gene") %>%
  filter(gene %in% c("Gzmb","Klrc1", "Klrc2","Klrd1")) 
```

    ##    gene        p_val avg_log2FC pct.1 pct.2    p_val_adj
    ## 1 Klrc1 1.905160e-72   3.487166 0.921 0.025 2.394977e-68
    ## 2 Klrd1 1.196772e-67   3.180395 0.939 0.060 1.504462e-63
    ## 3 Klrc2 2.279601e-58   2.176122 0.772 0.011 2.865687e-54
    ## 4  Gzmb 3.287915e-41   3.081300 0.693 0.067 4.133238e-37

1.  “…However, for T cells in TEff/EM p2, we found that the upregulation
    of IL7r was associated with IL18r1 (Figure 5C).

2.  “This analysis illustrated that these CXCR6+ effector cells were
    quite unique: on the one hand, they could be labeled as terminally
    exhausted cells (Wherry et al., 2007) based on their elevated
    expression of Pdcd1, Nr4a1 (Liu et al., 2019), Lag3, and Havcr2
    (Tim-3)..” And from Fig 5 legend: “Classical exhaustion markers
    Nr4a1, Lag3, and Havcr2 were upregulated in the tumor TEff/EM p4
    population.”

**Don’t know how to reproduce Fig 3 yet** “Figure 3. Two distinct
subsets that resemble either TEMs or TCMs comprise tumor and distant
mucosa TRMs… (B) Heatmap of top 100 DEGs between the tumor TEff/EM and
tumor TCMs shows the global gene expression pattern between these
circulating memory T cells and active and quiescent TRMs….(E) A global
enrichment of ribosome genes associates with tumor TCM and quiescent TRM
subsets.” (Christian et al. 2021 Cell Reports) **Note** In order to make
Fig3, need to (1) be able to distinguish between active and quiesent Trm
and disTrm cells. This depends on Monocle2 analysis. We also need (2) to
integrate the Tem and Tcm datasets which they did using …?
